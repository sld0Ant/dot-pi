#!/usr/bin/expect -f
set timeout 60
set env(PI_SKIP_VERSION_CHECK) 1

proc type_slow {text {delay 40}} {
    foreach char [split $text ""] {
        send -- $char
        after $delay
    }
}

spawn asciinema rec --overwrite --idle-time-limit 2 --window-size 80x24 -c pi recordings/codesearch.cast

expect "Sandbox"

type_slow "search for useEffect cleanup pattern in TypeScript"
send "\r"

sleep 25

send "\x03"
sleep 0.3
send "\x03"

expect eof
