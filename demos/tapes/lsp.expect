#!/usr/bin/expect -f
set timeout 90
set env(PI_SKIP_VERSION_CHECK) 1

proc type_slow {text {delay 40}} {
    foreach char [split $text ""] {
        send -- $char
        after $delay
    }
}

spawn asciinema rec --overwrite --idle-time-limit 2 --window-size 80x24 -c pi recordings/lsp.cast

expect "Sandbox"

type_slow "go to definition of parseChangelog in interactive-mode.ts"
send "\r"

sleep 30

send "\x03"
sleep 0.3
send "\x03"

expect eof
